@model eBond.ViewModels.PrintFinishedBondViewModel
@{
    Layout = null;
}
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="~/css/styleprinttocbond.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css" integrity="sha384-xOolHFLEh07PJGoPkLv1IbcEPTNtaed2xpHsD9ESMhqIYd0nLMwNLD69Npy4HI+N" crossorigin="anonymous">
    <title>Jaminan</title>

    <style type="text/css">
        @@page {
            size: 21.59cm 30.50cm;         
            margin-top: 5cm;
            margin-bottom: auto;
            margin-left: 2.74cm;
            margin-right: 1.33cm;
            height: auto !important;            
        }

        @@media print {
            .body {
                overflow: hidden;
                display: table;
                table-layout: flex;   
            }       
        }     
    </style>
</head>

<body>
    <div class="body" style="page-break-after: auto;">
        @if (ViewBag.PrintType == "COPY")
        {
            <div>
                <label class="copy">@ViewBag.PrintType</label>
                <br>
                <br>
            </div>
        }
        else
        {
            <div style="display: inline-block;margin-bottom: 1rem;">
                <label></label>
                <br>
                <br>
            </div>
        }
        <div class="header">
            <label>@ViewBag.HeaderTitle</label>
        </div>

        <br />

        <div class="bodytext">
            <label class="nomorjaminan">Nomor Jaminan: @Model.PolicyNo</label>
            <label class="nilai">Nilai : Rp. @String.Format("{0:N2}", Model.SumInsured)</label>
        </div>

        <br />

        <table class="table table-borderless tabletext">
            <tr>
                <td>1.</td>
                <td>
                    Dengan ini dinyatakan, bahwa kami :
                    <span class="spantext">@Model.CompanyName,</span>
                    <span class="spantext">@Model.Address,</span>
                    sebagai Peyedia, selanjutnya disebut TERJAMIN/ PRINCIPAL, dan
                    <span class="spantext">PT ASURANSI MITRA PELINDUNG MUSTIKA,</span>
                    <span class="spantext">AKR Tower Lt. 22, Jl. Panjang No.5 Kebon Jeruk, Jakarta Barat 11530</span>
                    sebagai Penjamin, selanjutnya disebut sebagai PENJAMIN/ SURETY, bertanggung jawab dan dengan tegas terikat pada
                    <span class="spantext">@Model.ObligeeName, @Model.ObligeeAddress</span>
                    sebagai Pemilik Pekerjaan, selanjutnya disebut PENERIMA JAMINAN/ OBLIGEE atas uang sejumlah
                    <span class="spantext">Rp. @String.Format("{0:N2}", Model.SumInsured)</span>
                    <span class="spantext">(<a id="outputNumber"></a>).</span>
                </td>
            </tr>

            <tr>
                <td class="tablenumber">2.</td>
                <td>                                        
                    @if(Model.IdTOCBond == "1102")
                    {
                        <label>
                            Maka kami, TERJAMIN/ PRINCIPAL dan PENJAMIN/ SURETY dengan ini mengikatkan diri untuk melakukan pembayaran jumlah tersebut dia atas dengan baik dan benar bilamana TERJAMIN/ PRINCIPAL tidak memenuhi kewajiban dalam melaksanakan <span class="spantext">@Model.ProjectName</span> sebagaimana ditetapkan berdasarkan <span class="spantext">Purchase Order No. : @Model.PONumber</span> tanggal <span class="spantext">@Model.PODate.ToString("dd MMMM yyyy", new System.Globalization.CultureInfo("id-ID"))</span> dari PENERIMA JAMINAN / OBLIGEE.
                        </label>
                        
                    }
                    else if (Model.IdTOCBond == "1104")
                    {
                        <label>
                            Maka kami, TERJAMIN/ PRINCIPAL dan PENJAMIN/ SURETY dengan ini mengikatkan diri untuk melakukan pembayaran jumlah tersebut dia atas dengan baik dan benar bilamana TERJAMIN/ PRINCIPAL tidak memenuhi kewajiban dalam melaksanakan <span class="spantext">@Model.ProjectName</span> sebagaimana ditetapkan berdasarkan <span class="spantext">Purchase Order No. : @Model.PONumber</span> tanggal <span class="spantext">@Model.PODate.ToString("dd MMMM yyyy", new System.Globalization.CultureInfo("id-ID"))</span> dan
                            <span class="spantext">
                                Berita Acara Serah Terima (BAST-I) No. : @Model.AdditionalDocument tanggal @Model.BASTDate.ToString("dd MMMM yyyy", new System.Globalization.CultureInfo("id-ID"))
                            </span>dari PENERIMA JAMINAN / OBLIGEE.
                        </label>
                    }
                    else if (Model.IdTOCBond == "1103")
                    {
                        if (Model.BASTDate.Date == DateTime.MinValue)
                        {
                            <label>Maka kami, TERJAMIN/ PRINCIPAL dan PENJAMIN/ SURETY dengan ini mengikatkan diri untuk melakukan pembayaran jumlah tersebut dia atas dengan baik dan benar bilamana TERJAMIN/ PRINCIPAL tidak memenuhi kewajiban dalam melaksanakan <span class="spantext">@Model.ProjectName</span> sebagaimana ditetapkan berdasarkan <span class="spantext">Purchase Order No. : @Model.PONumber</span> tanggal <span class="spantext">@Model.PODate.ToString("dd MMMM yyyy", new System.Globalization.CultureInfo("id-ID"))</span> dan dari PENERIMA JAMINAN / OBLIGEE.</label>
                        }
                        else if (Model.BASTDate.Date != DateTime.MinValue && Model.AdditionalDocument == null || Model.AdditionalDocument == "")
                        {
                            <label>
                                Maka kami, TERJAMIN/ PRINCIPAL dan PENJAMIN/ SURETY dengan ini mengikatkan diri untuk melakukan pembayaran jumlah tersebut dia atas dengan baik dan benar bilamana TERJAMIN/ PRINCIPAL tidak memenuhi kewajiban dalam melaksanakan <span class="spantext">@Model.ProjectName</span> sebagaimana ditetapkan berdasarkan <span class="spantext">Purchase Order No. : @Model.PONumber</span> tanggal <span class="spantext">@Model.PODate.ToString("dd MMMM yyyy", new System.Globalization.CultureInfo("id-ID"))</span> dan
                                <span class="spantext">
                                    Berita Acara Serah Terima (BAST-PP) Pekerjaan Persiapan tanggal @Model.BASTDate.ToString("dd MMMM yyyy", new System.Globalization.CultureInfo("id-ID"))
                                </span>  dari PENERIMA JAMINAN / OBLIGEE.
                            </label>
                        }
                        else
                        {
                            <label>
                                Maka kami, TERJAMIN/ PRINCIPAL dan PENJAMIN/ SURETY dengan ini mengikatkan diri untuk melakukan pembayaran jumlah tersebut dia atas dengan baik dan benar bilamana TERJAMIN/ PRINCIPAL tidak memenuhi kewajiban dalam melaksanakan <span class="spantext">@Model.ProjectName</span> sebagaimana ditetapkan berdasarkan <span class="spantext">Purchase Order No. : @Model.PONumber</span> tanggal <span class="spantext">@Model.PODate.ToString("dd MMMM yyyy", new System.Globalization.CultureInfo("id-ID"))</span> dan
                                <span class="spantext">
                                    Berita Acara Serah Terima (BAST-PP) Pekerjaan Persiapan No. : @Model.AdditionalDocument tanggal @Model.BASTDate.ToString("dd MMMM yyyy", new System.Globalization.CultureInfo("id-ID"))
                                </span> dari PENERIMA JAMINAN / OBLIGEE.
                            </label>
                        }
                    }
                </td>
            </tr>

            <tr>
                <td class="tablenumber">3.</td>
                <td>
                    Surat Jaminan ini berlaku selama
                    <span class="spantext"><a id="countDate"></a></span>
                    hari kalender dan efektif mulai dari tanggal
                    <span class="spantext">@Model.StartDate.ToString("dd MMMM yyyy", new System.Globalization.CultureInfo("id-ID"))</span>
                    sampai dengan tanggal
                    <span class="spantext">@Model.EndDate.ToString("dd MMMM yyyy", new System.Globalization.CultureInfo("id-ID")).</span>
                </td>
            </tr>

            <tr>
                <td class="tablenumber">4.</td>
                <td>
                    Syarat dan Ketentuan Jaminan ini sesuai dengan lampiran Surat Keputusan AAUI (Asosiasi Asuransi Umum Indonesia)
                    No. 13/SK.AAUI.2021.
                </td>
            </tr>
        </table>        

        <div class="signheader row">
            <div class="col-md-12">
                <label>
                    Dikeluarkan di
                    <span class="spantext">Jakarta</span>
                </label>
                <br>
                <label>
                    Pada tanggal
                    <span class="spantext">@Model.StartDate.ToString("dd MMMM yyyy", new System.Globalization.CultureInfo("id-ID"))</span>
                </label>
            </div>
        </div>
        <br />

        @*<div class="container">*@
        <table class="table table-borderless">
            <tr>
                <td>
                    <label class="signheader">TERJAMIN/ PRINCIPAL</label>
                    <br>
                    <label class="signheader" style="font-weight: 900;">@Model.CompanyName</label>
                </td>

                <td>
                    <label class="signheader">PENJAMIN/ SURETY</label>
                    <br>
                    <label class="signheader" style="font-weight: 900;">PT. ASURANSI MITRA PELINDUNG MUSTIKA</label>
                </td>
            </tr>
            <tr>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>
                    <label class="signtext">@Model.Signee</label>
                    <br>
                    <label style="font-family: Times New Roman, Times, serif !important;font-size:15.50pt;">@Model.SigneeTitle</label>
                </td>

                <td>
                    <label class="signtext">Hasmidan</label>
                    <br>
                    <label style="font-family: Times New Roman, Times, serif !important;font-size:15.50pt;">Manager Underwriting</label>
                </td>
            </tr>
        </table>
        <div class="signheader row col-md-6">
            <table class="table table-bordered" style="width: 400px;float:left; font-weight: bold;">
                <tr>
                    <td style="border: 2px solid black !important; padding:5px; width:100px;font-weight: bold; font-size: 15.50pt;">Imbal Jasa</td>
                    <td style="border: 2px solid black !important; padding:5px; width:100px;font-weight: bold; font-size: 15.50pt; width:170px;">Rp. @String.Format("{0:N2}", Model.RawTotal)</td>
                </tr>
            </table>
        </div>
        <br />
        <div class="row col-md-6">
            <br />
            @if (ViewBag.PrintType == "COPY")
            {
                var count = Model.DownloadCounterCopy + 1;
                <p style="font-size: 10px;">
                    Print Out: @count
                </p>
            }
            else
            {
                var count = Model.DownloadCounterOriginal + 1;
                <p style="font-size: 10px;">
                    Print Out: @count
                </p>
            }

        </div>
        @*</div>*@
        <input type="hidden" value="@Model.StartDate.ToString("yyyy-MM-dd")" id="newStartDate" />
        <input type="hidden" value="@Model.EndDate.ToString("yyyy-MM-dd")" id="newEndDate" />
        <input type="hidden" value="@String.Format("{0:0.00}", Model.SumInsured)" id="newProjectValue" />

    </div>
    <div class="footer">
    </div>
</body>


<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-Fy6S3B9q64WdZWQUiU+q4/2Lc9npb8tCaSX9FK7E8HnRr0Jz8D6OP9dO5Vg3Q9ct" crossorigin="anonymous"></script>

<script type="text/javascript">

    let countDate = document.getElementById("countDate");
    let newStartDate = document.getElementById("newStartDate").value;
    let newEndDate = document.getElementById("newEndDate").value;
    let newProjectValue = document.getElementById("newProjectValue").value;

    let date_1 = new Date(newStartDate);
    let date_2 = new Date(newEndDate);

    function days(date_1, date_2) {
        let difference = date_1 - date_2;
        let TotalDays = Math.ceil(difference / (1000 * 3600 * 24));

        return TotalDays;
    }

    function terbilang(bilangan) {
        if (bilangan == "" || bilangan == null || bilangan == "null" || bilangan == undefined) {
            return "";
        } else {
            bilangan = bilangan.replace(/[^,\d]/g, '');
            var kalimat = "";
            var angka = new Array('0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0');
            var kata = new Array('', 'Satu', 'Dua', 'Tiga', 'Empat', 'Lima', 'Enam', 'Tujuh', 'Delapan', 'Sembilan');
            var tingkat = new Array('', 'Ribu', 'Juta', 'Milyar', 'Triliun');
            var panjang_bilangan = bilangan.length;

            if (panjang_bilangan > 15) {
                kalimat = "Diluar Batas";
            } else {
                for (i = 1; i <= panjang_bilangan; i++) {
                    angka[i] = bilangan.substr(-(i), 1);
                }

                var i = 1;
                var j = 0;

                while (i <= panjang_bilangan) {
                    subkalimat = "";
                    kata1 = "";
                    kata2 = "";
                    kata3 = "";

                    if (angka[i + 2] != "0") {
                        if (angka[i + 2] == "1") {
                            kata1 = "Seratus";
                        } else {
                            kata1 = kata[angka[i + 2]] + " Ratus";
                        }
                    }

                    if (angka[i + 1] != "0") {
                        if (angka[i + 1] == "1") {
                            if (angka[i] == "0") {
                                kata2 = "Sepuluh";
                            } else if (angka[i] == "1") {
                                kata2 = "Sebelas";
                            } else {
                                kata2 = kata[angka[i]] + " Belas";
                            }
                        } else {
                            kata2 = kata[angka[i + 1]] + " Puluh";
                        }
                    }

                    if (angka[i] != "0") {
                        if (angka[i + 1] != "1") {
                            kata3 = kata[angka[i]];
                        }
                    }

                    if ((angka[i] != "0") || (angka[i + 1] != "0") || (angka[i + 2] != "0")) {
                        subkalimat = kata1 + " " + kata2 + " " + kata3 + " " + tingkat[j] + " ";
                    }

                    kalimat = subkalimat + kalimat;
                    i = i + 3;
                    j = j + 1;
                }

                if ((angka[5] == "0") && (angka[6] == "0")) {
                    kalimat = kalimat.replace("Satu Ribu", "Seribu");
                }
            }
            countDate.innerText = `${bilangan} ( ${kalimat})`
        }
    }

    var daysTotal = days(date_1, date_2).toString()
    console.log(terbilang(daysTotal))

    // Number to Word
    var th = ['', 'Ribu', 'Juta', 'Miliar', 'Biliar'];

    var dg = ['Nol', 'Satu', 'Dua', 'Tiga', 'Empat', 'Lima', 'Enam', 'Tujuh', 'Delapan', 'Sembilan'];
    var tn = ['Sepuluh', 'Sebelas', 'Dua Belas', 'Tiga Belas', 'Empat Belas', 'Lima Belas', 'Enam Belas', 'Tujuh Belas', 'Delapan Belas', 'Sembilan Belas'];
    var tw = ['Dua Puluh', 'Tiga Puluh', 'Empat Puluh', 'Lima Puluh', 'Enam Puluh', 'Tujuh Puluh', 'Delapan Puluh', 'Sembilan Puluh'];
    function toWords(s) {
        s = s.toString();
        s = s.replace(/[\, ]/g, '');
        if (s != parseFloat(s)) return 'not a number';
        var x = s.indexOf('.');
        if (x == -1) x = s.length;
        if (x > 15) return 'too big';
        var n = s.split('');
        var str = '';
        var sk = 0;
        for (var i = 0; i < x; i++) {
            if ((x - i) % 3 == 2) {
                if (n[i] == '1') {
                    str += tn[Number(n[i + 1])] + ' ';
                    i++;
                    sk = 1;
                } else if (n[i] != 0) {
                    str += tw[n[i] - 2] + ' ';
                    sk = 1;
                }
            } else if (n[i] != 0) {
                str += dg[n[i]] + ' ';
                if ((x - i) % 3 == 0) str += 'Ratus ';
                sk = 1;
            }
            if ((x - i) % 3 == 1) {
                if (sk) str += th[(x - i - 1) / 3] + ' ';
                sk = 0;
            }
        }
        if (x != s.length) {
            var y = s.length;
            str += 'point ';
            for (var i = x + 1; i < y; i++) str += dg[n[i]] + ' ';
        }
        return str.replace(/\s+/g, ' ');
    }

    function withDecimal(n) {
        var nums = n.split('.')
        var whole = toWords(nums[0])
        if (nums.length == 2) {
            var fraction = toWords(nums[1])
            if (nums[1] == '00') {
                outputNumber.innerText = whole + 'Rupiah';
                return whole + 'Rupiah';
            } else {
                outputNumber.innerText = whole + 'Rupiah ' + 'Dan ' + fraction + 'Sen';
                return whole + 'Rupiah ' + 'Dan ' + fraction + 'Sen';
            }
        } else {
            outputNumber.innerText = whole + 'Rupiah';
            return whole + 'Rupiah';
        }
    }
    console.log(withDecimal(newProjectValue))
</script>

@section Scripts {
    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
    }
    }
